<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Start Election</title>
    <!--STYLESHEET-->
    <!--=================================================-->
    <!--Roboto Slab Font [ OPTIONAL ] -->
    <link
      href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,300,100,700"
      rel="stylesheet"
    />
    <link
      href="http://fonts.googleapis.com/css?family=Roboto:500,400italic,100,700italic,300,700,500italic,400"
      rel="stylesheet"
    />
    <!--Bootstrap Stylesheet [ REQUIRED ]-->
    <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" />
    <!--Jasmine Stylesheet [ REQUIRED ]-->
    <link href="../../assets/css/style.css" rel="stylesheet" />
    <!--Font Awesome [ OPTIONAL ]-->
    <link
      href="../../assets/plugins/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
    />
    <!--SCRIPT-->
    <!--=================================================-->
    <script src="./node_modules/web3/dist/web3.min.js"></script>
  </head>
  <!--TIPS-->
  <!--You may remove all ID or Class names which contain "demo-", they are only used for demonstration. -->
  <body>
    <div id="container" class="effect mainnav-sm navbar-fixed mainnav-fixed">
      <!--NAVBAR-->
      <!--===================================================-->
      <header id="navbar">
        <div id="navbar-container" class="boxed">
          <!--Navbar Dropdown-->
          <!--================================-->
          <div class="navbar-content clearfix">
            <ul class="nav navbar-top-links pull-left">
              <!--Navigation toogle button-->
              <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
              <li class="tgl-menu-btn">
                <a class="mainnav-toggle" href="#">
                  <i class="fa fa-navicon fa-lg"></i>
                </a>
              </li>
              <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
              <!--End Navigation toogle button-->
            </ul>

            <ul class="nav navbar-top-links pull-right">
              <!--User dropdown-->
              <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
              <li id="dropdown-user" class="dropdown">
                <a
                  href="#"
                  data-toggle="dropdown"
                  class="dropdown-toggle text-right"
                >
                  <span class="pull-right">
                    <img
                      class="img-circle img-user media-object"
                      src="../../assets/img/av1.png"
                      alt="Profile Picture"
                    />
                  </span>
                  <div class="username hidden-xs">Admin</div>
                </a>
                <div class="dropdown-menu dropdown-menu-right with-arrow">
                  <!-- User dropdown menu -->
                  <ul class="head-list">
                    <li>
                      <a href="#">
                        <i class="fa fa-sign-out fa-fw"></i> Logout
                      </a>
                    </li>
                  </ul>
                </div>
              </li>
              <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
              <!--End user dropdown-->
            </ul>
          </div>
          <!--================================-->
          <!--End Navbar Dropdown-->
        </div>
      </header>
      <!--===================================================-->
      <!--END NAVBAR-->
      <div class="boxed">
        <!--CONTENT CONTAINER-->
        <!--===================================================-->
        <div id="content-container">
          <div class="pageheader hidden-xs">
            <h3><i class="fa fa-home"></i> Start Election</h3>
          </div>
          <!--Page content-->
          <div id="page-content">
            <div class="row">
              <div class="col-md-12">
                <div class="panel">
                  <div class="panel-heading">
                    <div class="panel-control"></div>
                  </div>
                  <div class="panel-body">
                    <!-- Inline Form  -->
                    <!--===================================================-->
                    <form class="form-inline">
                      <div class="form-group mar-hor" id="select_start_time">
                        <label for="demo-inline-inputmail" class="sr-only"
                          >Number of hours</label
                        >
                        <input
                          type="number"
                          placeholder="Hours..."
                          id="starttime"
                          class="form-control"
                        />
                      </div>
                      <a
                        class="btn btn-info"
                        type="submit"
                        onclick="onclickConfirm()"
                        id="startelec"
                        >Start</a
                      >
                    </form>
                    <!--===================================================-->
                    <!-- End Inline Form  -->
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--End page content-->
        </div>
        <!--===================================================-->
        <!--END CONTENT CONTAINER-->
        <!--MAIN NAVIGATION-->
        <!--===================================================-->
        <nav id="mainnav-container">
          <!--Brand logo & name-->
          <!--================================-->
          <div class="navbar-header">
            <a href="index.html" class="navbar-brand">
              <i class="fa fa-forumbee brand-icon"></i>
              <div class="brand-title">
                <span class="brand-text">SVS</span>
              </div>
            </a>
          </div>
          <!--================================-->
          <!--End brand logo & name-->
          <div id="mainnav">
            <!--Menu-->
            <!--================================-->
            <div id="mainnav-menu-wrap">
              <div class="nano">
                <div class="nano-content">
                  <ul id="mainnav-menu" class="list-group">
                    <!--Menu list item-->
                    <li>
                      <a href="../monitor/index.html">
                        <i class="fa fa-home"></i>
                        <span class="menu-title"> Dashboard </span>
                      </a>
                    </li>
                    <!--Menu list item-->
                    <li>
                      <a href="../candidates/candidates.html">
                        <i class="fa fa-user"></i>
                        <span class="menu-title">Candidates</span>
                      </a>
                    </li>
                    <!--Menu list item-->
                    <li>
                      <a href="../voters/voters.html">
                        <i class="fa fa-users"></i>
                        <span class="menu-title">Voters</span>
                      </a>
                    </li>
                    <!--Menu list item-->
                    <li>
                      <a href="../start/start-election.html">
                        <i class="fa fa-play"></i>
                        <span class="menu-title">Start Election</span>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <!--================================-->
            <!--End menu-->
          </div>
        </nav>
        <!--===================================================-->
        <!--END MAIN NAVIGATION-->
      </div>
      <!-- FOOTER -->
      <!--===================================================-->
      <footer id="footer">
        <p class="pad-lft">&#0169; 2022 Nixon Mkindi</p>
      </footer>
      <!--===================================================-->
      <!-- END FOOTER -->
      <!-- SCROLL TOP BUTTON -->
      <!--===================================================-->
      <button id="scroll-top" class="btn">
        <i class="fa fa-chevron-up"></i>
      </button>
      <!--===================================================-->
    </div>
    <!--===================================================-->
    <!-- END OF CONTAINER -->
    <!--JAVASCRIPT-->
    <!--=================================================-->
    <!--jQuery [ REQUIRED ]-->
    <script src="../../assets/js/jquery-2.1.1.min.js"></script>
    <!-- <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script> -->
    <script>
      function hideDetail() {
        var btn = document.getElementById("starttime");
        // btn.style.display = "none";
        var abc = document.getElementById("select_start_time");
        abc.innerHTML = "Election has been started for " + hours + "hours";
      }

      if (typeof web3 !== "undefined") {
        console.log("Already connected with web3.js");
        var web3 = new Web3(
          new Web3.providers.HttpProvider("http://localhost:8545")
        );
      } else {
        console.log("No web3 file...");
      }
      web3.eth.defaultAccount = web3.eth.accounts[0];

      let abi =
        '[{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"deployedBallots","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getsDeployedBallots","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string[][]","name":"candidates","type":"string[][]"},{"internalType":"string[][]","name":"position","type":"string[][]"},{"internalType":"string[]","name":"department","type":"string[]"},{"internalType":"uint256","name":"hour","type":"uint256"}],"name":"startelec","outputs":[],"stateMutability":"nonpayable","type":"function"}]';

      // let account = "0x94409d36a8a415E9B091D37221CEEEa7B09cfA68"; // geth
      let account = "0x369da7512A64D4cf5bd3450654446e062DafbdCE"; // private-geth
      // let account = "0x69a14C179Af496c5b040546043C21aDDE4A14E7E"; // ganache

      let bytecode =
        "0x608060405234801561001057600080fd5b50611c44806100206000396000f3fe60806040523480156200001157600080fd5b5060043610620000465760003560e01c80630e3e4a75146200004b5780638455faf8146200006d578063cdf74c3e146200008d575b600080fd5b62000055620000c3565b60405162000064919062000773565b60405180910390f35b6200008b600480360362000085919081019062000492565b62000153565b005b620000ab6004803603620000a5919081019062000549565b6200025d565b604051620000ba919062000756565b60405180910390f35b606060008054806020026020016040519081016040528092919081815260200182805480156200014957602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311620000fe575b5050505050905090565b60008090505b8251811015620002565760008582815181106200017257fe5b60200260200101518583815181106200018757fe5b60200260200101518584815181106200019c57fe5b60200260200101513386604051620001b4906200029a565b620001c495949392919062000797565b604051809103906000f080158015620001e1573d6000803e3d6000fd5b5090506000819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050808060010191505062000159565b5050505050565b600081815481106200026b57fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6111a68062000a6983390190565b600082601f830112620002ba57600080fd5b8135620002d1620002cb8262000837565b62000809565b9150818183526020840193506020810190508360005b838110156200031b578135860162000300888262000325565b845260208401935060208301925050600181019050620002e7565b5050505092915050565b600082601f8301126200033757600080fd5b81356200034e620003488262000860565b62000809565b9150818183526020840193506020810190508360005b838110156200039857813586016200037d88826200041f565b84526020840193506020830192505060018101905062000364565b5050505092915050565b600082601f830112620003b457600080fd5b8135620003cb620003c58262000889565b62000809565b9150818183526020840193506020810190508360005b83811015620004155781358601620003fa88826200041f565b845260208401935060208301925050600181019050620003e1565b5050505092915050565b600082601f8301126200043157600080fd5b8135620004486200044282620008b2565b62000809565b915080825260208301602083018583830111156200046557600080fd5b62000472838284620009f8565b50505092915050565b6000813590506200048c8162000a4e565b92915050565b60008060008060808587031215620004a957600080fd5b600085013567ffffffffffffffff811115620004c457600080fd5b620004d287828801620002a8565b945050602085013567ffffffffffffffff811115620004f057600080fd5b620004fe87828801620002a8565b935050604085013567ffffffffffffffff8111156200051c57600080fd5b6200052a87828801620003a2565b92505060606200053d878288016200047b565b91505092959194509250565b6000602082840312156200055c57600080fd5b60006200056c848285016200047b565b91505092915050565b6000620005838383620005b6565b60208301905092915050565b60006200059d8383620006c3565b905092915050565b620005b081620009bc565b82525050565b620005c1816200097e565b82525050565b620005d2816200097e565b82525050565b6000620005e582620008ff565b620005f181856200093a565b9350620005fe83620008df565b8060005b838110156200063557815162000619888262000575565b9750620006268362000920565b92505060018101905062000602565b5085935050505092915050565b60006200064f826200090a565b6200065b81856200094b565b9350836020820285016200066f85620008ef565b8060005b85811015620006b157848403895281516200068f85826200058f565b94506200069c836200092d565b925060208a0199505060018101905062000673565b50829750879550505050505092915050565b6000620006d08262000915565b620006dc81856200095c565b9350620006ee81856020860162000a07565b620006f98162000a3d565b840191505092915050565b6000620007118262000915565b6200071d81856200096d565b93506200072f81856020860162000a07565b6200073a8162000a3d565b840191505092915050565b6200075081620009b2565b82525050565b60006020820190506200076d6000830184620005c7565b92915050565b600060208201905081810360008301526200078f8184620005d8565b905092915050565b600060a0820190508181036000830152620007b3818862000642565b90508181036020830152620007c9818762000642565b90508181036040830152620007df818662000704565b9050620007f06060830185620005a5565b620007ff608083018462000745565b9695505050505050565b6000604051905081810181811067ffffffffffffffff821117156200082d57600080fd5b8060405250919050565b600067ffffffffffffffff8211156200084f57600080fd5b602082029050602081019050919050565b600067ffffffffffffffff8211156200087857600080fd5b602082029050602081019050919050565b600067ffffffffffffffff821115620008a157600080fd5b602082029050602081019050919050565b600067ffffffffffffffff821115620008ca57600080fd5b601f19601f8301169050602081019050919050565b6000819050602082019050919050565b6000819050602082019050919050565b600081519050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b6000602082019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b60006200098b8262000992565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b6000620009c982620009d0565b9050919050565b6000620009dd82620009e4565b9050919050565b6000620009f18262000992565b9050919050565b82818337600083830152505050565b60005b8381101562000a2757808201518184015260208101905062000a0a565b8381111562000a37576000848401525b50505050565b6000601f19601f8301169050919050565b62000a5981620009b2565b811462000a6557600080fd5b5056fe60806040523480156200001157600080fd5b50604051620011a6380380620011a683398181016040526200003791908101906200042f565b81600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555082600290805190602001906200009092919062000196565b5060008090505b85518110156200018a5760006040518060a00160405280888481518110620000bb57fe5b60200260200101518152602001878481518110620000d557fe5b6020026020010151815260200160008152602001428152602001844201815250908060018154018082558091505060019003906000526020600020906005020160009091909190915060008201518160000190805190602001906200013c9291906200021d565b5060208201518160010190805190602001906200015b9291906200021d565b506040820151816002015560608201518160030155608082015181600401555050808060010191505062000097565b50505050505062000655565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620001d957805160ff19168380011785556200020a565b828001600101855582156200020a579182015b8281111562000209578251825591602001919060010190620001ec565b5b509050620002199190620002a4565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200026057805160ff191683800117855562000291565b8280016001018555821562000291579182015b828111156200029057825182559160200191906001019062000273565b5b509050620002a09190620002a4565b5090565b620002c991905b80821115620002c5576000816000905550600101620002ab565b5090565b90565b600081519050620002dd8162000621565b92915050565b600082601f830112620002f557600080fd5b81516200030c62000306826200052a565b620004fc565b9150818183526020840193506020810190508360005b838110156200035657815186016200033b888262000360565b84526020840193506020830192505060018101905062000322565b5050505092915050565b600082601f8301126200037257600080fd5b815162000389620003838262000553565b620004fc565b91508082526020830160208301858383011115620003a657600080fd5b620003b3838284620005eb565b50505092915050565b600082601f830112620003ce57600080fd5b8151620003e5620003df8262000580565b620004fc565b915080825260208301602083018583830111156200040257600080fd5b6200040f838284620005eb565b50505092915050565b60008151905062000429816200063b565b92915050565b600080600080600060a086880312156200044857600080fd5b600086015167ffffffffffffffff8111156200046357600080fd5b6200047188828901620002e3565b955050602086015167ffffffffffffffff8111156200048f57600080fd5b6200049d88828901620002e3565b945050604086015167ffffffffffffffff811115620004bb57600080fd5b620004c988828901620003bc565b9350506060620004dc88828901620002cc565b9250506080620004ef8882890162000418565b9150509295509295909350565b6000604051905081810181811067ffffffffffffffff821117156200052057600080fd5b8060405250919050565b600067ffffffffffffffff8211156200054257600080fd5b602082029050602081019050919050565b600067ffffffffffffffff8211156200056b57600080fd5b601f19601f8301169050602081019050919050565b600067ffffffffffffffff8211156200059857600080fd5b601f19601f8301169050602081019050919050565b6000620005ba82620005c1565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60005b838110156200060b578082015181840152602081019050620005ee565b838111156200061b576000848401525b50505050565b6200062c81620005ad565b81146200063857600080fd5b50565b6200064681620005e1565b81146200065257600080fd5b50565b610b4180620006656000396000f3fe608060405234801561001057600080fd5b50600436106100885760003560e01c8063a3ec138d1161005b578063a3ec138d14610119578063b2c2f2e814610149578063d8bb8d9314610179578063e13804a7146101a957610088565b80630121b93f1461008d5780633477ee2e146100a9578063481c6a75146100dd5780638a824c76146100fb575b600080fd5b6100a760048036036100a2919081019061086c565b6101d9565b005b6100c360048036036100be919081019061086c565b6102b8565b6040516100d49594939291906109ae565b60405180910390f35b6100e561042b565b6040516100f29190610934565b60405180910390f35b610103610451565b604051610110919061096a565b60405180910390f35b610133600480360361012e9190810190610843565b6104ef565b604051610140919061094f565b60405180910390f35b610163600480360361015e919081019061086c565b61050f565b6040516101709190610a0f565b60405180910390f35b610193600480360361018e919081019061086c565b610591565b6040516101a0919061098c565b60405180910390f35b6101c360048036036101be919081019061086c565b6106d5565b6040516101d0919061098c565b60405180910390f35b600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161561023057600080fd5b60016000828154811061023f57fe5b9060005260206000209060050201600201600082825401925050819055506001600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555050565b600081815481106102c557fe5b9060005260206000209060050201600091509050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156103715780601f1061034657610100808354040283529160200191610371565b820191906000526020600020905b81548152906001019060200180831161035457829003601f168201915b505050505090806001018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561040f5780601f106103e45761010080835404028352916020019161040f565b820191906000526020600020905b8154815290600101906020018083116103f257829003601f168201915b5050505050908060020154908060030154908060040154905085565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60028054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104e75780601f106104bc576101008083540402835291602001916104e7565b820191906000526020600020905b8154815290600101906020018083116104ca57829003601f168201915b505050505081565b60036020528060005260406000206000915054906101000a900460ff1681565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461056b57600080fd5b6000828154811061057857fe5b9060005260206000209060050201600201549050919050565b6060600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146105ed57600080fd5b600082815481106105fa57fe5b906000526020600020906005020160040154421161061757600080fd5b6000828154811061062457fe5b90600052602060002090600502016001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156106c95780601f1061069e576101008083540402835291602001916106c9565b820191906000526020600020905b8154815290600101906020018083116106ac57829003601f168201915b50505050509050919050565b6060600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461073157600080fd5b6000828154811061073e57fe5b906000526020600020906005020160040154421161075b57600080fd5b6000828154811061076857fe5b90600052602060002090600502016000018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561080d5780601f106107e25761010080835404028352916020019161080d565b820191906000526020600020905b8154815290600101906020018083116107f057829003601f168201915b50505050509050919050565b60008135905061082881610add565b92915050565b60008135905061083d81610af4565b92915050565b60006020828403121561085557600080fd5b600061086384828501610819565b91505092915050565b60006020828403121561087e57600080fd5b600061088c8482850161082e565b91505092915050565b61089e81610a51565b82525050565b6108ad81610a63565b82525050565b60006108be82610a35565b6108c88185610a40565b93506108d8818560208601610a99565b6108e181610acc565b840191505092915050565b60006108f782610a2a565b6109018185610a40565b9350610911818560208601610a99565b61091a81610acc565b840191505092915050565b61092e81610a8f565b82525050565b60006020820190506109496000830184610895565b92915050565b600060208201905061096460008301846108a4565b92915050565b6000602082019050818103600083015261098481846108ec565b905092915050565b600060208201905081810360008301526109a681846108b3565b905092915050565b600060a08201905081810360008301526109c881886108ec565b905081810360208301526109dc81876108ec565b90506109eb6040830186610925565b6109f86060830185610925565b610a056080830184610925565b9695505050505050565b6000602082019050610a246000830184610925565b92915050565b600081519050919050565b600081519050919050565b600082825260208201905092915050565b6000610a5c82610a6f565b9050919050565b60008115159050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60005b83811015610ab7578082015181840152602081019050610a9c565b83811115610ac6576000848401525b50505050565b6000601f19601f8301169050919050565b610ae681610a51565b8114610af157600080fd5b50565b610afd81610a8f565b8114610b0857600080fd5b5056fea2646970667358221220f8f546a3521065974478e5764f6cc299df903e16ad70c5fe97a0e8539fd6418764736f6c63430006010033a2646970667358221220eaf1c05db7d0937bbebbdd154f01d5a89199171d3f0c2fba31ff509e09e96ecd64736f6c63430006010033";

      // let Electioncreationcontract = new web3.eth.Contract(JSON.parse(abi));

      let payload = {
        data: bytecode,
      };
      let parameter = {
        from: account,
        gas: web3.utils.toHex(5000000),
        gasPrice: web3.utils.toHex(web3.utils.toWei("30", "gwei")),
      };
      //web3.eth.personal.unlockAccount(account,"123", 15000)
      var contractAddress;

      try {
        var sampleContract = new web3.eth.Contract(JSON.parse(abi)); //		   6000000
        sampleContract.options.data = bytecode; //No Need to include '0x' if you have already included it as prefix in the byteCode.// 4000000}
        var contractAddress;
        sampleContract
          .deploy(payload)
          .send(parameter)
          .then((receipt) => {
            if (receipt) {
              contractAddress = receipt.options.address;

              console.log(contractAddress);
              //here receipt is nothing but contractInstanceFromDeployedContract
            }
          })
          .catch(function (error) {
            // LOG ERROR
            console.log(error);
          });
      } catch (excep) {
        // LOG EXCEPTION
        console.log(excep);
      }

      // START THE ELECTION
      function onclickConfirm() {
        console.log(contractAddress);

        // console.log(Electioncreationcontract);
        let requestURL = "http://localhost:3000/candidates";
        let request = new XMLHttpRequest();
        request.open("GET", requestURL);
        request.responseType = "json";
        request.send();
        request.onload = function () {
          const candidates = request.response;
          //console.log(candidates) /// Use this JSON array to load on to the smart contract.
          var o = -1;
          for (i = 0; i < candidates.length; i++) {
            if (candidateDepartment.indexOf(candidates[i].department) == -1) {
              candidateDepartment.push(candidates[i].department);
              o += 1;
              candidatePosition[o] = [];
              candidateNames[o] = [];
            }

            candidateNames[o].push(candidates[i].name);

            candidatePosition[o].push(candidates[i].position);
          }

          console.log(candidateDepartment);
          // console.log(candidatePosition);

          // ELECTION TIME
          var hours = $("#starttime").val();
          try {
            Electioncreationcontract = new web3.eth.Contract(
              JSON.parse(abi),
              contractAddress
            );

            const secondFunction = async () => {
              var btn = document.getElementById("startelec");
              // btn.style.display = "none";
              const result = await Electioncreationcontract.methods
                .startelec(
                  candidateNames,
                  candidatePosition,
                  candidateDepartment,
                  hours
                )
                .send({ from: account, gas: 6000000 });
              // const a = Electioncreationcontract.methods.getsDeployedBallots();
              // console.log(a.call().value)
              let ballots = await Electioncreationcontract.methods
                .getsDeployedBallots()
                .call({ from: account, gas: 6000000 });
              console.log(ballots);
              var jsonToPush = [];

              console.log("Loaded ballots");

              for (i = 0; i < ballots.length; i++) {
                var jsonObject = {};
                jsonObject["department"] = candidateDepartment[i];
                jsonObject["address"] = ballots[i];
                console.log(jsonObject);
                jsonToPush.push(jsonObject);
              }
              console.log(JSON.stringify(jsonToPush));
              let xhr = new XMLHttpRequest();
              let url_post = "http://localhost:3000/contracts";

              xhr.open("POST", url_post, true);
              xhr.setRequestHeader("Content-Type", "application/json");

              xhr.send(JSON.stringify(jsonToPush));
              console.log("Addresses sent to database...");

              console.log(Electioncreationcontract);
              // do something else here after firstFunction completes
            };
            secondFunction();
          } catch (e) {
            console.log(e);
          } //.methods.myFunction().call();
        };
      }
      var i;
      var candidateNames = [];
      var candidatePosition = new Array();
      var candidateDepartment = new Array();
    </script>
    <!--Jquery Nano Scroller js [ REQUIRED ]-->
    <script src="../../assets/plugins/nanoscrollerjs/jquery.nanoscroller.min.js"></script>
    <!--Metismenu js [ REQUIRED ]-->
    <script src="../../assets/plugins/metismenu/metismenu.min.js"></script>
    <!--Jasmine Admin [ RECOMMENDED ]-->
    <script src="../../assets/js/scripts.js"></script>
    <!--Demo script [ DEMONSTRATION ]-->
    <script src="../../assets/js/demo/form-layout.js"></script>
  </body>
</html>
